<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pillarbox - Development Page</title>
    <link rel="icon" type="image/x-icon" href="img/favicon.ico">
    <link rel="stylesheet" href="./scss/pillarbox.scss" />

    <style>
      html,
      body {
        height: 100%;
      }

      body {
        margin: 0;
        overflow: hidden;
      }

      .pillarbox-js {
        height: 50% !important;
      }
    </style>
  </head>

  <body>
    <video id="player" class="pillarbox-js" controls muted></video>
    <video id="player2" class="pillarbox-js" controls muted></video>

    <script type="module">
      import pillarbox from './src/pillarbox.js';
      import './src/middleware/srgssr.js';

      const searchParams = new URLSearchParams(location.search);
      const debug = searchParams.has('debug');

      // Expose Pillarbox and player in the window object for debugging
      window.pillarbox = pillarbox;

      // Allows to track comscore events until TC becomes Pillarbox-compatible
      window.videojs = pillarbox;

      window.player = new pillarbox('player', {
        debug
      });

      window.player2 = new pillarbox('player2', {
        debug
      });

      player.controlBar.lockShowing();
      player2.controlBar.lockShowing();

      function pauseInstancesOnPlay() {
        pillarbox.getAllPlayers().forEach(p => {
          if (p === this) return;

          p.pause();
        })
      }

      player.on('play', pauseInstancesOnPlay);
      player2.on('play', pauseInstancesOnPlay);

      player.on('loadeddata', () => {
        player.currentTime(911);
      })
      player.src({
        src: 'urn:rts:video:9883196',
        type: 'srgssr/urn',
      });
      player2.src({
        src: 'urn:srf:video:4b23273b-c983-45b7-87b2-277480d0f704',
        type: 'srgssr/urn',
      });
    </script>
  </body>

</html>
