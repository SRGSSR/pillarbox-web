<!DOCTYPE html><html lang="en" style="font-size:16px"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="docs/api/img/favicon.ico"><link type="text/css" rel="stylesheet" href="docs.css"><title>Source: trackers/SRGAnalytics.js</title><!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><script src="scripts/third-party/hljs.js" defer="defer"></script><script src="scripts/third-party/hljs-line-num.js" defer="defer"></script><script src="scripts/third-party/popper.js" defer="defer"></script><script src="scripts/third-party/tippy.js" defer="defer"></script><script src="scripts/third-party/tocbot.min.js"></script><script>var baseURL="/",locationPathname="";baseURL=(locationPathname=document.location.pathname).substr(0,locationPathname.lastIndexOf("/")+1)</script><link rel="stylesheet" href="styles/clean-jsdoc-theme.min.css"><svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none"><defs><symbol id="copy-icon" viewbox="0 0 488.3 488.3"><g><path d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z"/><path d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z"/></g></symbol><symbol id="search-icon" viewBox="0 0 512 512"><g><g><path d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z"/></g></g><g><g><path d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z"/></g></g></symbol><symbol id="font-size-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11.246 15H4.754l-2 5H.6L7 4h2l6.4 16h-2.154l-2-5zm-.8-2L8 6.885 5.554 13h4.892zM21 12.535V12h2v8h-2v-.535a4 4 0 1 1 0-6.93zM19 18a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></symbol><symbol id="add-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2z"/></symbol><symbol id="minus-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M5 11h14v2H5z"/></symbol><symbol id="dark-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938 7.999 7.999 0 0 0 4 12z"/></symbol><symbol id="light-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/></symbol><symbol id="reset-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M18.537 19.567A9.961 9.961 0 0 1 12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10c0 2.136-.67 4.116-1.81 5.74L17 12h3a8 8 0 1 0-2.46 5.772l.997 1.795z"/></symbol><symbol id="down-icon" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"></path></symbol><symbol id="codepen-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M16.5 13.202L13 15.535v3.596L19.197 15 16.5 13.202zM14.697 12L12 10.202 9.303 12 12 13.798 14.697 12zM20 10.869L18.303 12 20 13.131V10.87zM19.197 9L13 4.869v3.596l3.5 2.333L19.197 9zM7.5 10.798L11 8.465V4.869L4.803 9 7.5 10.798zM4.803 15L11 19.131v-3.596l-3.5-2.333L4.803 15zM4 13.131L5.697 12 4 10.869v2.262zM2 9a1 1 0 0 1 .445-.832l9-6a1 1 0 0 1 1.11 0l9 6A1 1 0 0 1 22 9v6a1 1 0 0 1-.445.832l-9 6a1 1 0 0 1-1.11 0l-9-6A1 1 0 0 1 2 15V9z"/></symbol><symbol id="close-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"/></symbol><symbol id="menu-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z"/></symbol></defs></svg></head><body data-theme="fallback-dark"><div class="sidebar-container"><div class="sidebar" id="sidebar"><a href="/pillarbox-web/dist/api/" class="sidebar-title sidebar-title-anchor"><img src="./docs/api/img/pillarbox-logo.webp" height="40px">pillarbox-web</a><div class="sidebar-items-container"><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-classes"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="DataProvider.html">DataProvider</a></div><div class="sidebar-section-children"><a href="MediaComposition.html">MediaComposition</a></div><div class="sidebar-section-children"><a href="PillarboxMonitoring.html">PillarboxMonitoring</a></div><div class="sidebar-section-children"><a href="Player.html">Player</a></div><div class="sidebar-section-children"><a href="SRGAnalytics.html">SRGAnalytics</a></div><div class="sidebar-section-children"><a href="SrgSsr.html">SrgSsr</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-namespaces"><div>Namespaces</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="pillarbox.html">pillarbox</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-tutorials"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-Events.html">Events</a></div><div class="sidebar-section-children"><a href="tutorial-Known Issues.html">Known Issues</a></div><div class="sidebar-section-children"><a href="tutorial-Options.html">Options</a></div><div class="sidebar-section-children"><a href="tutorial-Player Tips and Tricks.html">Player Tips and Tricks</a></div><div class="sidebar-section-children"><a href="tutorial-Supported Media Types.html">Supported Media Types</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-interfaces"><div>Interfaces</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="KeySystems.html">KeySystems</a></div><div class="sidebar-section-children"><a href="global.html#MainResource">MainResource</a></div><div class="sidebar-section-children"><a href="MainResourceWithKeySystems.html">MainResourceWithKeySystems</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-global"><div>Global</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="global.html#AudioTrack">AudioTrack</a></div><div class="sidebar-section-children"><a href="global.html#AudioType">AudioType</a></div><div class="sidebar-section-children"><a href="global.html#BlockReason">BlockReason</a></div><div class="sidebar-section-children"><a href="global.html#BroadcastInformation">BroadcastInformation</a></div><div class="sidebar-section-children"><a href="global.html#Channel">Channel</a></div><div class="sidebar-section-children"><a href="global.html#Chapter">Chapter</a></div><div class="sidebar-section-children"><a href="global.html#ComposedSrcMediaData">ComposedSrcMediaData</a></div><div class="sidebar-section-children"><a href="global.html#Credit">Credit</a></div><div class="sidebar-section-children"><a href="global.html#DrmMetadata">DrmMetadata</a></div><div class="sidebar-section-children"><a href="global.html#Episode">Episode</a></div><div class="sidebar-section-children"><a href="global.html#HbbtvProperties">HbbtvProperties</a></div><div class="sidebar-section-children"><a href="global.html#Headline">Headline</a></div><div class="sidebar-section-children"><a href="global.html#Language">Language</a></div><div class="sidebar-section-children"><a href="global.html#Link">Link</a></div><div class="sidebar-section-children"><a href="global.html#MainResource">MainResource</a></div><div class="sidebar-section-children"><a href="global.html#MediaInfo">MediaInfo</a></div><div class="sidebar-section-children"><a href="global.html#MetadataInfo">MetadataInfo</a></div><div class="sidebar-section-children"><a href="global.html#PillarboxMonitoringOptions">PillarboxMonitoringOptions</a></div><div class="sidebar-section-children"><a href="global.html#PlaybackPosition">PlaybackPosition</a></div><div class="sidebar-section-children"><a href="global.html#PlayerCurrentDimensions">PlayerCurrentDimensions</a></div><div class="sidebar-section-children"><a href="global.html#PlayerInfo">PlayerInfo</a></div><div class="sidebar-section-children"><a href="global.html#PlayerProperty">PlayerProperty</a></div><div class="sidebar-section-children"><a href="global.html#PresentationType">PresentationType</a></div><div class="sidebar-section-children"><a href="global.html#Presenter">Presenter</a></div><div class="sidebar-section-children"><a href="global.html#Program">Program</a></div><div class="sidebar-section-children"><a href="global.html#QoeTimings">QoeTimings</a></div><div class="sidebar-section-children"><a href="global.html#QosTimings">QosTimings</a></div><div class="sidebar-section-children"><a href="global.html#QualityType">QualityType</a></div><div class="sidebar-section-children"><a href="global.html#RelatedContent">RelatedContent</a></div><div class="sidebar-section-children"><a href="global.html#Representation">Representation</a></div><div class="sidebar-section-children"><a href="global.html#Resource">Resource</a></div><div class="sidebar-section-children"><a href="global.html#Resource">Resource</a></div><div class="sidebar-section-children"><a href="global.html#SRGAnalyticsOptions">SRGAnalyticsOptions</a></div><div class="sidebar-section-children"><a href="global.html#ScheduledBroadcast">ScheduledBroadcast</a></div><div class="sidebar-section-children"><a href="global.html#Segment">Segment</a></div><div class="sidebar-section-children"><a href="global.html#Show">Show</a></div><div class="sidebar-section-children"><a href="global.html#SocialCountEntry">SocialCountEntry</a></div><div class="sidebar-section-children"><a href="global.html#SpriteSheet">SpriteSheet</a></div><div class="sidebar-section-children"><a href="global.html#SrgOptions">SrgOptions</a></div><div class="sidebar-section-children"><a href="global.html#StallInfo">StallInfo</a></div><div class="sidebar-section-children"><a href="global.html#StartEventData">StartEventData</a></div><div class="sidebar-section-children"><a href="global.html#StatusEventData">StatusEventData</a></div><div class="sidebar-section-children"><a href="global.html#StreamingType">StreamingType</a></div><div class="sidebar-section-children"><a href="global.html#SubTopic">SubTopic</a></div><div class="sidebar-section-children"><a href="global.html#Subtitle">Subtitle</a></div><div class="sidebar-section-children"><a href="global.html#SubtitleInformation">SubtitleInformation</a></div><div class="sidebar-section-children"><a href="global.html#TimeInterval">TimeInterval</a></div><div class="sidebar-section-children"><a href="global.html#TokenType">TokenType</a></div><div class="sidebar-section-children"><a href="global.html#Topic">Topic</a></div><div class="sidebar-section-children"><a href="global.html#TrackSelector">TrackSelector</a></div><div class="sidebar-section-children"><a href="global.html#TrackSourceType">TrackSourceType</a></div><div class="sidebar-section-children"><a href="global.html#TransmissionType">TransmissionType</a></div><div class="sidebar-section-children"><a href="global.html#VendorType">VendorType</a></div></div></div></div></div><div class="navbar-container" id="VuAckcnZhf"><nav class="navbar"><div class="navbar-left-items"><div class="navbar-item"><a id="" href="https://demo.pillarbox.ch/showcase" target="_blank">Showcase</a></div><div class="navbar-item"><a id="" href="https://editor.pillarbox.ch" target="_blank">Theme Editor</a></div><div class="navbar-item"><a id="" href="./tutorial-Known%20Issues.html" target="_blank">Known Issues</a></div><div class="navbar-item"><a id="" href="https://github.com/SRGSSR/pillarbox-web" target="_blank">Code</a></div></div><div class="navbar-right-items"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#dark-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div><nav></nav></nav></div><div class="toc-container"><div class="toc-content"><span class="bold">On this page</span><div id="eed4d2a0bfd64539bb9df78095dec881"></div></div></div><div class="body-wrapper"><div class="main-content"><div class="main-wrapper"><section id="source-page" class="source-page"><header><h1 id="title" class="has-anchor">trackers_SRGAnalytics.js</h1></header><article><pre class="prettyprint source lang-js"><code>/** @import { SRGAnalyticsOptions } from './typedef.ts' */

/* eslint max-lines-per-function: ["error", 200] */
/* eslint max-statements: ["error", 30]*/
/* eslint complexity: ["error", 10]*/

/**
 * The SRG analytics class tracks media playback according to the standard defined by SRG SSR.
 *
 * @class SRGAnalytics
 *
 * ### Official documentation
 *
 * - [New variable list]{@link https://srgssr-ch.atlassian.net/wiki/spaces/INTFORSCHUNG/pages/1009353309/Labels+check+for+migration+of+integration+layer+in+SAM}
 * - [Variables list]{@link https://srgssr-ch.atlassian.net/wiki/spaces/INTFORSCHUNG/pages/795904478/Datalayer+for+media+players}
 * - [Standard event sequences]{@link https://srgssr-ch.atlassian.net/wiki/spaces/INTFORSCHUNG/pages/795904171/standard+streaming+events+sequence+of+events+for+media+player+actions}
 * - [Review of Standard Media Actions]{@link https://srgssr-ch.atlassian.net/wiki/spaces/INTFORSCHUNG/pages/795902249/Implementation+Concept+-+draft}
 * - [ComScore Implementation Guide]{@link https://www.dropbox.com/sh/cdwuikq0abxi21m/AABmSyXYKUTWSAwRZgQA9Ujna/JavaScript%20Latest%20Version?dl=0&amp;preview=Comscore_Library-JavaScript-Streaming_Tag-Implementation_Guide-International.pdf&amp;subfolder_nav_tracking=1}
 *
 * ### Script URL
 *
 * JS script : https://colibri-js.akamaized.net/penguin/tc_SRGGD_11.js
 *
 * ### Variables list
 *
 * - event_id: init | play | stop | pos | pause | seek | uptime | eof
 * - event_timestamp: Seems to be generated automatically from the documentation, but the TP overrides it
 * - event_name: NA TP seems to not sending this variable
 * - event_source: NA TP seems to not sending this variable
 * - event_name: NA TP seems to not sending this variable
 * - event_value: NA TP seems to not sending this variable
 * - navigation_environment: prod | preprod
 * - media_subtitles_on: string true | false
 * - media_timeshift: need better description
 * - media_quality: SD | HD ?
 * - media_bandwidth: NA for the web, 64000
 * - media_volume: from 0 to 100
 * - media_embedding_url:
 * - media_player_name: videojs | letterbox-web ?
 * - media_chromecast_selected: boolean true | false
 * - media_player_version: player's version
 * - media_player_display: is the player mode, on the TP : inline, embed etc..
 * - media_audio_track: NA
 * - media_position_real: NA
 * - media_time_spent: NA
 * - device_id: NA
 * - user_id_log_in: NA only RTS has log in today
 * - media_thumbnail: Not required by the spec but sended by the TP
 * - media_bu_distributer: Not required by the spec but sended by the TP
 *
 * ### Sequence stories
 *
 * #### Story 1 (AoD/VOD-basics): A VoD is played. The user does not interact with the player. The VoD plays to its end.
 *
 * Hints:
 * - Media sessions always start with PLAY. They end with STOP or EOF (or with PAUSE or last POS)
 * - POS is sent ever 30s
 *
 * #### Story 2 (livestream-basics A): A Livestream is played. The user does not interact with the player. After 61 seconds, playback is paused.
 *
 * Hints:
 * - Media sessions always start with PLAY. They end with STOP (or, worse for data quailty, with PAUSE or last POS/UPTIME)
 * - UPTIME is sent only for livestreams
 * - POS is sent ever 30s, UPTIME every 60s with inital UPTIME after 30s.
 * - This is the interval: 30s: POS + UPTIME; 60s: POS; 90s: POS + UPTIME; ...
 *
 * #### Story 3 (Seeking a VoD/AoD): A VoD is played. User seeks in the VoD/AoD.
 *
 * Hints:
 * - Once the Media Player slider is released (seek is over), another action to finish up the seeking is initiated. Typically this is PLAY. For that second PLAY, the media position has altered.
 *
 * #### Story 4 (Seeking a livestream): A Livestream is played. User goes back in the livestream.
 *
 * Hints:
 * - Once the Media Player slider is released (seek is over), another action to finish up the seeking is initiated. Typically this is PLAY.  For that second PLAY, the a new variable, media_timeshift is passed.
 * - For livestreams media_position is always the "time passed on your watch" - regardless of the SEEK event. So, if 1 second after PLAY the slider is moved  back 600 seconds, then:
 *  1. The the value of media_timeshift is '600'.
 *  2. The value of media_position is '1'.
 */
class SRGAnalytics {
  /**
   * Creates an instance of SRGAnalytics.
   *
   * @constructor
   * @param {HTMLVideoElement} player The player instance
   * @param {SRGAnalyticsOptions} [options={}] Configuration options
   * @param {boolean} [options.debug=false] Enables debug mode if set to true
   * @param {string} [options.environment='prod'] The environment in which the data is sent
   * @param {string} [options.playerVersion='none'] The version of the player
   * @param {string} [options.tagCommanderScriptURL='//colibri-js.akamaized.net/penguin/tc_SRGGD_11.js'] The URL for the Tag Commander script
   */
  constructor(
    player,
    {
      debug = false,
      environment = 'prod',
      playerVersion = 'none',
      tagCommanderScriptURL = '//colibri-js.akamaized.net/penguin/tc_SRGGD_11.js',
    } = {}
  ) {
    this.isDebugEnabled = debug;
    this.elapsedPlaybackTime = 0;
    this.environment = environment;
    this.hasStarted = false;
    this.heartBeatIntervalId = undefined;
    /* Set to true when 'init' event is sent or queued. */
    this.initialized = false;
    this.initialeMediaDuration = 0;
    this.isSeeking = false;
    this.isWaiting = false;
    this.mediaSession = 0;
    this.pendingQueue = [];
    this.pendingTagCommanderReload = false;
    this.playbackData = undefined;
    /** @type {HTMLVideoElement} */
    this.player = player;
    this.playerVersion = playerVersion;
    this.startPlaybackSession = 0;
    this.tagCommanderScriptURL = tagCommanderScriptURL;
    this.trackedCurrentTime = 0;
    this.uptimeIntervalId = undefined;

    this.initScript();
    this.initListeners();
  }

  /** Set the playback data */
  setPlaybackData(data) {
    this.playbackData = data;
  }

  /**
   * Sent when the window, the document and its resources are about to be unloaded.
   *
   * @see https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload_event
   */
  beforeunload() {
    this.notify('stop');
  }

  /**
   * Clear timers used to send uptime and heartbeat.
   */
  clearTimers() {
    clearInterval(this.heartBeatIntervalId);
    clearInterval(this.uptimeIntervalId);
    clearTimeout(this.uptimeTimeoutId);
  }

  /**
   * Get the tracked current time in seconds.
   *
   * @returns {Number} current time in seconds
   */
  currentTime() {
    // see PLAYRTS-2771
    return Math.round(this.trackedCurrentTime);
  }

  /**
   * Get or set debug mode.
   *
   * @returns {Boolean|undefined}
   */
  debug(enabled) {
    if (enabled === undefined) {
      return this.isDebugEnabled || this.playbackData.debug() || false;
    }

    this.isDebugEnabled = Boolean(enabled);
  }

  /**
   * Destroy all properties and setIntervals to avoid mixing media sessions.
   */
  destroy() {
    this.clearTimers();

    if (!window.tc_vars) {
      window.tc_vars = {};
    }
    this.elapsedPlaybackTime = 0;
    this.hasStarted = false;
    this.heartBeatIntervalId = undefined;
    this.initialized = false;
    this.initialeMediaDuration = 0;
    this.isWaiting = false;
    this.mediaSession = 0;
    this.pendingQueue = [];
    this.playbackData = undefined;
    this.startPlaybackSession = 0;
    this.trackedCurrentTime = 0;
    this.uptimeIntervalId = undefined;
  }

  /**
   * Dispose all listeners used to send analytics data to TagCommander.
   *
   * Calls `beforeunload` to send a notify stop.
   * Clear intervals and timeouts.
   *
   * __Used events__
   * - beforeunload
   * - emptied
   * - ended
   * - loadstart
   * - loadeddata
   * - play
   * - pause
   * - timeupdate
   */
  dispose() {
    this.beforeunload();
    this.clearTimers();

    window.removeEventListener('beforeunload', this.beforeunloadListener);

    this.player
      .removeEventListener('emptied', this.emptiedListener);
    this.player
      .removeEventListener('ended', this.endedListener);
    this.player
      .removeEventListener('loadstart', this.loadstartListener);
    this.player
      .removeEventListener('loadeddata', this.loadeddataListener);
    this.player
      .removeEventListener('playing', this.playListener);
    this.player
      .removeEventListener('pause', this.pauseListener);
    this.player
      .removeEventListener('ratechange', this.rateChangeListener);
    this.player
      .removeEventListener('seeking', this.seekingListener);
    this.player
      .removeEventListener('timeupdate', this.timeUpdateListener);
    this.player
      .removeEventListener('waiting', this.waitingListener);
  }

  /**
   * Sent before a new media is loading.
   * - Destroy all properties.
   * - Send a notify stop if the media is not ended and new media is about to be loaded.
   */
  emptied() {
    if (!this.player.ended) {
      this.notify('stop');
    }

    this.destroy();
  }

  /**
   * Sent when playback completes.
   *
   * @see https://docs.videojs.com/player#event:ended
   */
  ended() {
    this.notify('eof');

    this.mediaSession = 0;

    this.clearTimers();
  }

  /**
   * Flush the queued events when tc event script is loaded.
   */
  flush() {
    if (this.isTrackerDisabled()) return;

    if (this.pendingTagCommanderReload &amp;&amp; window.tC) {
      window.tC.container.reload();
      this.pendingTagCommanderReload = false;
    }

    if (window.tc_events_11 &amp;&amp; this.pendingQueue.length > 0) {
      this.pendingQueue.forEach((notification) => {
        window.tc_events_11(
          this.player,
          notification.action,
          notification.labels
        );
      });

      this.pendingQueue = [];
    }
  }

  /**
   * Get the language of the current audio track.
   *
   * @returns {String} empty string or uppercase language.
   */
  getCurrentAudioTrack() {
    const currentTrack = this.playbackData.audioTrack();
    let language = currentTrack
      &amp;&amp; !!currentTrack.language ? currentTrack.language : 'und';

    return currentTrack ? language.toUpperCase() : '';
  }

  /**
   * Get the language of the current text track.
   *
   * @returns {String} empty string or uppercase language.
   */
  getCurrentTextTrack() {
    const currentTrack = this.playbackData.textTrack();
    let language = 'und';

    if (currentTrack &amp;&amp; !!currentTrack.language) {
      // eslint-disable-next-line prefer-destructuring
      language = currentTrack.language;
    }

    return currentTrack ? language.toUpperCase() : '';
  }

  /**
   * Get the position inside the dvr window where the 0 represents the live edge
   *
   * @return {Number} 0 or the position in milliseconds
   */
  getDvrWindowPosition() {
    const currentTime = this.player.currentTime * 1000;
    const dvrWindowSize = this.getDvrWindowSize();
    const position = (dvrWindowSize - currentTime) | 0;

    return position &lt; 0 || position === Infinity ? 0 : position * 1000;
  }

  /**
   * Get the size of the live DVR window in milliseconds.
   *
   * @return {Number} DVR window size in milliseconds
   */
  getDvrWindowSize() {
    const hasSeekableRange = Boolean(this.player.seekable.length);

    if (!hasSeekableRange) return 0;

    const seekableEnd = this.player.seekable.end(0);
    const dvrWindowSize = seekableEnd - (
      seekableEnd - this.initialeMediaDuration
    );
    const dvrWindowSizeMS = (dvrWindowSize * 1000) | 0;

    return dvrWindowSizeMS;
  }

  /**
   * Get the elapsed playback time in seconds.
   *
   * @returns {Number} elapsed time in seconds
   */
  getElapsedPlaybackTime() {
    if (this.startPlaybackSession) {
      return this.getElapsedPlayingTime();
    }

    return this.elapsedPlaybackTime;
  }

  /**
   * Get the elapsed playing time in seconds.
   *
   * @returns {Number} elapsed time in seconds
   */
  getElapsedPlayingTime() {
    const playingSession = (SRGAnalytics.now() - this.startPlaybackSession) | 0;

    return this.elapsedPlaybackTime + playingSession;
  }

  /**
   * Set all event labels to be sent to TagCommander. The event labels are updated whenever a new event occurs.
   *
   * @param {String} eventName init | play | stop | pos | pause | seek | uptime | eof
   *
   * @returns {Object} JSON to be sent to TagCommander
   */
  getEventLabels(eventName) {
    const labels = {
      event_id: eventName,
      event_timestamp: SRGAnalytics.now(),
      media_dvr_window_length: 0,
      media_dvr_window_offset: 0,
      media_is_dvr: this.playbackData.analyticsMetadata.media_is_dvr,
      media_is_live: this.playbackData.analyticsMetadata.media_is_live,
      media_mute: this.player.muted ? '1' : '0',
      media_playback_rate: this.player.playbackRate,
      media_position: this.currentTime(),
      media_quality: this.playbackData
        .analyticsMetadata.media_streaming_quality,
      media_subtitles_on: this.isTextTrackEnabled(),
      media_volume: (this.player.volume * 100).toFixed(0),
      navigation_environment: this.environment,
    };

    if (this.isAudioTrackEnabled()) {
      labels.media_audio_track = this.getCurrentAudioTrack();
      labels.media_audiodescription_on = this.isAudioDescriptionEnabled();
    }

    if (this.isTextTrackEnabled()) {
      labels.media_subtitle_selection = this.getCurrentTextTrack();
    }

    // DVR or Live related labels
    if (!this.isMediaOnDemand()) {
      labels.media_is_live = true;
      labels.media_position = this.getElapsedPlaybackTime();
    }

    // DVR related labels
    if (this.isMediaDvr()) {
      labels.media_dvr_window_offset = this.getDvrWindowPosition();
      labels.media_dvr_window_length = this.getDvrWindowSize();

      labels.media_is_dvr = true;

      labels.media_timeshift = ['play', 'pause'].includes(
        eventName
      )
        ? this.timeShifted()
        : 0;
    }

    return labels;
  }

  /**
   * Set all internal labels to be sent to TagCommander. Internal labels are assigned once at initialisation time.
   */
  getInternalLabels() {
    const data = {
      // media_bu_distributer: this.srcMediaData.mediaData.vendor,
      media_bu_distributer: this.playbackData
        .analyticsMetadata.media_enterprise_units,
      // media_chromecast_selected: Boolean(this.player.tech(true).isCasting),
      media_chromecast_selected: Boolean(false),
      media_embedding_url: document.referrer,
      media_player_display: 'default', // TODO implement if it still relevant
      media_player_name: 'pillarbox-web', // TODO add a property playerName in the constructor with a default value ?
      media_player_version: this.playerVersion,
      // media_url: this.srcMediaData.src, // provided by the media composition
    };
    const analyticsMetadata = this.playbackData.analyticsMetadata || {};

    window.tc_vars = Object.assign({}, window.tc_vars, data, analyticsMetadata);
  }

  /**
   * Heart beat, current position of a AoD/VoD (every 30s).
   *
   * @description The action pos should be sent regularly every 30 seconds.
   * It is used for tracking the viewed chapters of a video and the last position of the video, in case the user ends the video by closing the browser tab/window.
   *
   * - pos should be sent when the media player is in "play mode".
   * - once the video is paused or stopped, the timer for sending these actions must be stopped.
   *
   * @see https://confluence.srg.beecollaboration.com/display/INTFORSCHUNG/standard+streaming+events%3A+sequence+of+events+for+media+player+actions#standardstreamingevents:sequenceofeventsformediaplayeractions-mandatoryplayerevents
   */
  heartBeat() {
    this.heartBeatIntervalId = setInterval(() => {
      // Send only when playing
      if (!this.player.paused) {
        this.notify('pos');
      }
    }, 30_000);
  }

  /**
   * Initialize callbacks used to send analytics data to TagCommander.
   *
   * __Used events__
   * - beforeunload
   * - emptied
   * - ended
   * - loadstart
   * - loadeddata
   * - play
   * - pause
   * - ratechange
   * - seeking
   * - timeupdate
   * - waiting
   */
  initCallbacks() {
    this.beforeunloadListener = this.beforeunload.bind(this);
    this.emptiedListener = this.emptied.bind(this);
    this.endedListener = this.ended.bind(this);
    this.loadstartListener = this.loadstart.bind(this);
    this.loadeddataListener = this.loadeddata.bind(this);
    this.playListener = this.play.bind(this);
    this.pauseListener = this.pause.bind(this);
    this.rateChangeListener = this.rateChange.bind(this);
    this.seekingListener = this.seeking.bind(this);
    this.timeUpdateListener = this.timeUpdate.bind(this);
    this.waitingListener = this.waiting.bind(this);
  }

  /**
   * Initialize all listeners used to send analytics data to TagCommander.
   *
   * __Used events__
   * - beforeunload
   * - dispose
   * - emptied
   * - ended
   * - loadstart
   * - loadeddata
   * - play
   * - pause
   * - timeupdate
   * - waiting
   */
  initListeners() {
    this.initCallbacks();

    window.addEventListener('beforeunload', this.beforeunloadListener);

    this.player
      .addEventListener('emptied', this.emptiedListener);
    this.player
      .addEventListener('ended', this.endedListener);
    this.player
      .addEventListener('loadstart', this.loadstartListener);
    this.player
      .addEventListener('loadeddata', this.loadeddataListener);
    this.player
      .addEventListener('playing', this.playListener);
    this.player
      .addEventListener('pause', this.pauseListener);
    this.player
      .addEventListener('ratechange', this.rateChangeListener);
    this.player
      .addEventListener('seeking', this.seekingListener);
    this.player
      .addEventListener('timeupdate', this.timeUpdateListener);
    this.player
      .addEventListener('waiting', this.waitingListener);

    const playerDisposeObserver = new MutationObserver(() => {
      this.dispose();
      playerDisposeObserver.disconnect();
    });

    playerDisposeObserver.observe(
      this.player.parentElement,
      { childList: true }
    );
  }

  /**
   * Initialize TagCommander script dynamically and add it to the DOM
   */
  initScript() {
    const scriptId = 'tc_script__11';

    if (!document.querySelector(`#${scriptId}`)) {
      const script = document.createElement('script');
      const src = this.tagCommanderScriptURL;

      script.defer = true;
      script.id = scriptId;
      script.src = src;
      script.type = 'text/javascript';

      script.onload = (_e) => {
        this.flush();
      };

      document.body.appendChild(script);
    }
  }

  /**
   * Check if the audio description track is enabled.
   *
   * @returns {Boolean} __true__ if enabled __false__ otherwise.
   */
  isAudioDescriptionEnabled() {
    const currentTrack = Array
      .from(this.player.audioTracks || {})
      .find(track => track.enabled &amp;&amp; track.kind.includes('desc'));

    return Boolean(currentTrack);
  }

  /**
   * Check if the audio track is enabled.
   *
   * @returns {Boolean} __true__ if enabled __false__ otherwise.
   */
  isAudioTrackEnabled() {
    return !!this.getCurrentAudioTrack();
  }

  /**
   * Check if the media is a live with DVR.
   *
   * @returns {Boolean} __true__ if it DVR __false__ otherwise.
   */
  isMediaDvr() {
    const {
      media_is_dvr,
      media_is_live
    } = this.playbackData.analyticsMetadata;

    return media_is_dvr &amp;&amp; media_is_live;
  }

  /**
   * Check if the media is a live. If
   *
   * @returns {Boolean} __true__ if live __false__ otherwise.
   */
  isMediaLive() {
    const {
      media_is_dvr,
      media_is_live
    } = this.playbackData.analyticsMetadata;

    return media_is_live &amp;&amp; !media_is_dvr;
  }

  /**
   * Check if the media is an on demand.
   *
   * @returns {Boolean} __true__ if on demand __false__ otherwise.
   */
  isMediaOnDemand() {
    const {
      media_is_dvr,
      media_is_live
    } = this.playbackData.analyticsMetadata;

    return !media_is_dvr &amp;&amp; !media_is_live;
  }

  /**
   * Check if the text track is enabled.
   *
   * @returns {Boolean} __true__ if enabled __false__ otherwise.
   */
  isTextTrackEnabled() {
    return !!this.getCurrentTextTrack();
  }

  /**
   * Check if the tracker is disabled.
   *
   * @returns {Boolean} __true__ if disabled __false__ otherwise.
   */
  isTrackerDisabled() {
    if (!this.playbackData || !this.playbackData.analyticsMetadata)
      return true;

    if (!Array.isArray(this.playbackData.disableTrackers)) {
      return Boolean(this.playbackData.disableTrackers);
    }

    return Boolean(
      this.playbackData.disableTrackers.find(
        (tracker) => tracker.toLowerCase() === SRGAnalytics.name.toLowerCase()
      )
    );
  }

  /**
   * Sent when loading of the media begins.
   *
   * @see https://docs.videojs.com/player#event:loadstart
   */
  loadstart() {
    if (this.isTrackerDisabled()) return;

    this.getInternalLabels();
    // Set ComScore labels
    this.reloadTagCommanderContainer();

    this.notify('buffer_start');
    this.hasStarted = false;
  }

  /**
   * The first frame of the media has finished loading.
   *
   * @see https://docs.videojs.com/player#event:loadeddata
   */
  loadeddata() {
    this.notify('init');
    this.initialized = true;
    this.initialeMediaDuration = this.player
      .seekable.length ? this.player.seekable.end(0) : 0;

    this.notify('buffer_stop');
  }

  /**
   * Event logger that prints the current event, event labels and internal labels in the browser's console.
   *
   * @param {String} eventName init | play | stop | pos | pause | seek | uptime | eof
   * @param {Object} eventMetadata event metadata object
   * @param {String} severity log | warn | error
   */
  log(eventName, eventMetadata, severity = 'log') {
    if (this.debug()) {
      // eslint-disable-next-line
      console[severity](
        `SRGAnalytics:${eventName}`,
        eventMetadata,
        window.tc_vars
      );
    }
  }

  /**
   * Notify TagCommander all event and internal labels. If tc script is not available it queues all pending events.
   *
   * @param {String} eventName init | play | stop | pos | pause | seek | uptime | eof
   */
  notify(eventName, eventMetadata) {
    if (this.isTrackerDisabled()) return;

    try {
      this.flush();
    } catch (error) {
      this.log(eventName, error, 'error');
    }

    const labels = Object.assign(
      {},
      this.getEventLabels(eventName),
      eventMetadata
    );

    this.log(eventName, labels);

    try {
      if (window.tc_events_11) {
        window.tc_events_11(this.player, eventName, labels);
      } else {
        this.pendingQueue.push({
          action: eventName,
          labels,
        });
      }
    } catch (error) {
      this.log(eventName, error, 'error');
    }
  }

  /**
   * Return the current timestamp in seconds.
   *
   * @returns {Number} Timestamp in seconds
   */
  static now() {
    return (Date.now() / 1000).toFixed(0);
  }

  /**
   * Sent when the playback state is no longer paused, as a result of the play method, or the autoplay attribute.
   *
   * @see https://docs.videojs.com/player#event:play
   */
  play() {
    if (!this.hasStarted) this.hasStarted = true;

    if (!this.startPlaybackSession &amp;&amp; !this.isMediaOnDemand()) {
      this.startPlaybackSession = SRGAnalytics.now();
    }

    if (this.mediaSession === 0) {
      this.mediaSession = SRGAnalytics.now();

      this.heartBeat();
      this.uptime();
    }

    this.timeUpdate();
    this.notify('play');

    if (this.isSeeking) this.isSeeking = false;
  }

  /**
   * Sent when the playback state is changed to paused (paused property is true).
   * Pause event is sent if :
   * - The player is not scrubbing
   * - The stream is not a live only
   * - The current time is strictly inferior to the duration
   *
   * @see https://docs.videojs.com/player#event:pause
   */
  pause() {
    if (!this.isMediaOnDemand()) {
      this.elapsedPlaybackTime = this.getElapsedPlayingTime();
      this.startPlaybackSession = 0;
    }

    if (
      !this.player.seeking &amp;&amp;
      !this.isMediaLive() &amp;&amp;
      this.player.currentTime &lt; this.player.duration
    ) {
      this.notify('pause');

      return;
    }

    if (this.hasStarted &amp;&amp; !this.isSeeking) {
      this.notify('seek');
      this.isSeeking = true;
    }
  }

  /**
   * Sent to ComScore when the playback rate changes.
   *
   * @see https://github.com/SRGSSR/srgletterbox-web/issues/761
   * @see https://jira.srg.beecollaboration.com/browse/ADI-256
   */
  rateChange() {
    this.notify('change_playback_rate');
  }

  /**
   * Reload the tagCommander container and set all ComScore labels
   */
  reloadTagCommanderContainer() {
    if (window.tC) {
      window.tC.container.reload();
      this.pendingTagCommanderReload = false;
    } else {
      this.pendingTagCommanderReload = true;
    }
  }

  /**
   * Sent when the current time is modified by the player's currentTime API.
   *
   * @see https://docs.videojs.com/player#event:seeking
   */
  seeking() {
    if (this.hasStarted &amp;&amp; !this.player.paused &amp;&amp; !this.isSeeking) {
      this.notify('seek');
      this.isSeeking = true;
    }
  }

  /**
   * Track current time updates delayed by a tick.
   *
   * @see https://docs.videojs.com/player#event:timeupdate
   */
  timeUpdate() {
    if (!this.player.paused) {
      this.trackedCurrentTime = this.player.currentTime;
    }
  }

  /**
   * Gets the number of seconds that separate from the live edge that is represented by 0.
   *
   * @returns {String}
   */
  timeShifted() {
    const liveEdgeThreshold = 120;
    const isAtLiveEdge = this.player.currentTime >= (
      this.player.duration - liveEdgeThreshold
    );
    const liveCurrentTime = this.player.duration;
    const currentTime = this.player.currentTime;
    const timeShifted = isAtLiveEdge
      ? 0
      : (liveCurrentTime - currentTime).toFixed(0);

    return timeShifted;
  }

  /**
   * Update the src media data.
   */
  updateSrcMediaData(srcMediaData) {
    this.srcMediaData = srcMediaData;
  }

  /**
   * Calculate the uptime when playing a live stream with or without DVR
   *
   * __Rules__:
   * - Send the first uptime after 30 seconds
   * - Send uptime each 60 seconds after the 30 seconds
   * - Uptime is sent only when playing
   */
  uptime() {
    const notifyUptime = () => {
      if (!this.player.paused &amp;&amp; !this.isMediaOnDemand()) {
        this.notify('uptime');
      }
    };

    // Send the first uptime after 30 seconds
    this.uptimeTimeoutId = setTimeout(() => {
      // Send only when playing
      notifyUptime();

      // Initialize the uptime interval after 30 seconds
      this.uptimeIntervalId = setInterval(() => {
        // Send only when playing
        notifyUptime();
      }, 60000);
    }, 30000);
  }

  /**
   *  __ComScore__:
   * It's expected notifyBufferStart() to be called when the player starts buffering
   * and a call to notifyBufferStop() when content resumes after buffering.
   *
   * @see Item 2: https://jira.srg.beecollaboration.com/browse/PLAY-2628
   *
   * After the issue PLAYRTS-321
   * @see Fix: https://jira.srg.beecollaboration.com/browse/PLAYRTS-321?focusedCommentId=201023&amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-201023
   * @see Fix: https://jira.srg.beecollaboration.com/browse/PLAYRTS-3065
   */
  waiting() {
    if (!this.initialized || this.isWaiting) {
      return;
    }

    const bufferStop = () => {
      this.isWaiting = false;
      this.notify('buffer_stop');
    };

    this.isWaiting = true;

    this.notify('buffer_start');

    // As Safari is not consistent with its playing event, it is better to use the timeupdate event.
    if (this.playbackData.browser.IS_ANY_SAFARI) {
      this.player.addEventListener(
        'timeupdate',
        bufferStop,
        { once: true }
      );
    } else {
      // As Chromium-based browsers are not consistent with their timeupdate event, it is better to use the playing event.
      // Firefox is consistent with its playing event.
      this.player.addEventListener(
        'playing',
        bufferStop,
        { once: true }
      );
    }
  }
}

export default SRGAnalytics;
</code></pre></article></section><footer class="footer" id="PeOAagUepe"><div class="wrapper"><a href="https://www.srgssr.ch/en" target="_blank"><img alt="SRG SSR" src="./docs/api/img/srgssr-logo.png" height="18px"></a><span>Swiss Broadcasting Corporation</span></div></footer></div></div></div><div class="search-container" id="PkfLWpAbet" style="display:none"><div class="wrapper" id="iCxFxjkHbP"><button class="icon-button search-close-button" id="VjLlGakifb" aria-label="close search"><svg><use xlink:href="#close-icon"></use></svg></button><div class="search-box-c"><svg><use xlink:href="#search-icon"></use></svg> <input type="text" id="vpcKVYIppa" class="search-input" placeholder="Search..." autofocus></div><div class="search-result-c" id="fWwVHRuDuN"><span class="search-result-c-text">Type anything to view search result</span></div></div></div><div class="mobile-menu-icon-container"><button class="icon-button" id="mobile-menu" data-isopen="false" aria-label="menu"><svg><use xlink:href="#menu-icon"></use></svg></button></div><div id="mobile-sidebar" class="mobile-sidebar-container"><div class="mobile-sidebar-wrapper"><a href="/pillarbox-web/dist/api/" class="sidebar-title sidebar-title-anchor"><img src="./docs/api/img/pillarbox-logo.webp" height="40px">pillarbox-web</a><div class="mobile-nav-links"><div class="navbar-item"><a id="" href="https://demo.pillarbox.ch/showcase" target="_blank">Showcase</a></div><div class="navbar-item"><a id="" href="https://editor.pillarbox.ch" target="_blank">Theme Editor</a></div><div class="navbar-item"><a id="" href="./tutorial-Known%20Issues.html" target="_blank">Known Issues</a></div><div class="navbar-item"><a id="" href="https://github.com/SRGSSR/pillarbox-web" target="_blank">Code</a></div></div><div class="mobile-sidebar-items-c"><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-classes"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="DataProvider.html">DataProvider</a></div><div class="sidebar-section-children"><a href="MediaComposition.html">MediaComposition</a></div><div class="sidebar-section-children"><a href="PillarboxMonitoring.html">PillarboxMonitoring</a></div><div class="sidebar-section-children"><a href="Player.html">Player</a></div><div class="sidebar-section-children"><a href="SRGAnalytics.html">SRGAnalytics</a></div><div class="sidebar-section-children"><a href="SrgSsr.html">SrgSsr</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-namespaces"><div>Namespaces</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="pillarbox.html">pillarbox</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-tutorials"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-Events.html">Events</a></div><div class="sidebar-section-children"><a href="tutorial-Known Issues.html">Known Issues</a></div><div class="sidebar-section-children"><a href="tutorial-Options.html">Options</a></div><div class="sidebar-section-children"><a href="tutorial-Player Tips and Tricks.html">Player Tips and Tricks</a></div><div class="sidebar-section-children"><a href="tutorial-Supported Media Types.html">Supported Media Types</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-interfaces"><div>Interfaces</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="KeySystems.html">KeySystems</a></div><div class="sidebar-section-children"><a href="global.html#MainResource">MainResource</a></div><div class="sidebar-section-children"><a href="MainResourceWithKeySystems.html">MainResourceWithKeySystems</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-global"><div>Global</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="global.html#AudioTrack">AudioTrack</a></div><div class="sidebar-section-children"><a href="global.html#AudioType">AudioType</a></div><div class="sidebar-section-children"><a href="global.html#BlockReason">BlockReason</a></div><div class="sidebar-section-children"><a href="global.html#BroadcastInformation">BroadcastInformation</a></div><div class="sidebar-section-children"><a href="global.html#Channel">Channel</a></div><div class="sidebar-section-children"><a href="global.html#Chapter">Chapter</a></div><div class="sidebar-section-children"><a href="global.html#ComposedSrcMediaData">ComposedSrcMediaData</a></div><div class="sidebar-section-children"><a href="global.html#Credit">Credit</a></div><div class="sidebar-section-children"><a href="global.html#DrmMetadata">DrmMetadata</a></div><div class="sidebar-section-children"><a href="global.html#Episode">Episode</a></div><div class="sidebar-section-children"><a href="global.html#HbbtvProperties">HbbtvProperties</a></div><div class="sidebar-section-children"><a href="global.html#Headline">Headline</a></div><div class="sidebar-section-children"><a href="global.html#Language">Language</a></div><div class="sidebar-section-children"><a href="global.html#Link">Link</a></div><div class="sidebar-section-children"><a href="global.html#MainResource">MainResource</a></div><div class="sidebar-section-children"><a href="global.html#MediaInfo">MediaInfo</a></div><div class="sidebar-section-children"><a href="global.html#MetadataInfo">MetadataInfo</a></div><div class="sidebar-section-children"><a href="global.html#PillarboxMonitoringOptions">PillarboxMonitoringOptions</a></div><div class="sidebar-section-children"><a href="global.html#PlaybackPosition">PlaybackPosition</a></div><div class="sidebar-section-children"><a href="global.html#PlayerCurrentDimensions">PlayerCurrentDimensions</a></div><div class="sidebar-section-children"><a href="global.html#PlayerInfo">PlayerInfo</a></div><div class="sidebar-section-children"><a href="global.html#PlayerProperty">PlayerProperty</a></div><div class="sidebar-section-children"><a href="global.html#PresentationType">PresentationType</a></div><div class="sidebar-section-children"><a href="global.html#Presenter">Presenter</a></div><div class="sidebar-section-children"><a href="global.html#Program">Program</a></div><div class="sidebar-section-children"><a href="global.html#QoeTimings">QoeTimings</a></div><div class="sidebar-section-children"><a href="global.html#QosTimings">QosTimings</a></div><div class="sidebar-section-children"><a href="global.html#QualityType">QualityType</a></div><div class="sidebar-section-children"><a href="global.html#RelatedContent">RelatedContent</a></div><div class="sidebar-section-children"><a href="global.html#Representation">Representation</a></div><div class="sidebar-section-children"><a href="global.html#Resource">Resource</a></div><div class="sidebar-section-children"><a href="global.html#Resource">Resource</a></div><div class="sidebar-section-children"><a href="global.html#SRGAnalyticsOptions">SRGAnalyticsOptions</a></div><div class="sidebar-section-children"><a href="global.html#ScheduledBroadcast">ScheduledBroadcast</a></div><div class="sidebar-section-children"><a href="global.html#Segment">Segment</a></div><div class="sidebar-section-children"><a href="global.html#Show">Show</a></div><div class="sidebar-section-children"><a href="global.html#SocialCountEntry">SocialCountEntry</a></div><div class="sidebar-section-children"><a href="global.html#SpriteSheet">SpriteSheet</a></div><div class="sidebar-section-children"><a href="global.html#SrgOptions">SrgOptions</a></div><div class="sidebar-section-children"><a href="global.html#StallInfo">StallInfo</a></div><div class="sidebar-section-children"><a href="global.html#StartEventData">StartEventData</a></div><div class="sidebar-section-children"><a href="global.html#StatusEventData">StatusEventData</a></div><div class="sidebar-section-children"><a href="global.html#StreamingType">StreamingType</a></div><div class="sidebar-section-children"><a href="global.html#SubTopic">SubTopic</a></div><div class="sidebar-section-children"><a href="global.html#Subtitle">Subtitle</a></div><div class="sidebar-section-children"><a href="global.html#SubtitleInformation">SubtitleInformation</a></div><div class="sidebar-section-children"><a href="global.html#TimeInterval">TimeInterval</a></div><div class="sidebar-section-children"><a href="global.html#TokenType">TokenType</a></div><div class="sidebar-section-children"><a href="global.html#Topic">Topic</a></div><div class="sidebar-section-children"><a href="global.html#TrackSelector">TrackSelector</a></div><div class="sidebar-section-children"><a href="global.html#TrackSourceType">TrackSourceType</a></div><div class="sidebar-section-children"><a href="global.html#TransmissionType">TransmissionType</a></div><div class="sidebar-section-children"><a href="global.html#VendorType">VendorType</a></div></div></div><div class="mobile-navbar-actions"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#dark-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div></div></div><script type="text/javascript" src="scripts/core.min.js"></script><script src="scripts/search.min.js" defer="defer"></script><script src="scripts/third-party/fuse.js" defer="defer"></script><script type="text/javascript">var tocbotInstance=tocbot.init({tocSelector:"#eed4d2a0bfd64539bb9df78095dec881",contentSelector:".main-content",headingSelector:"h1, h2, h3",hasInnerContainers:!0,scrollContainer:".main-content",headingsOffset:130,onClick:bringLinkToView})</script></body></html>